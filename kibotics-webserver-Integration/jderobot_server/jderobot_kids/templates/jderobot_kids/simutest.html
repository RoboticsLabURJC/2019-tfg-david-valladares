{% extends "jderobot_kids/base.html" %}
{% load static %}
{% block content %}

<link rel="stylesheet" href='{% static "css/theory.css" %}'>
<link rel="stylesheet" type="text/css" href='{% static "css/simulation.css" %}'>


<script>
    $(document).ready(function () {
        $('#media').carousel({
            pause: true,
            interval: false,
        });
        $('[data-toggle="popover"]').popover({
            placement: 'right',
            trigger: 'hover',
            container: 'body'
   });
});
</script>


<div style="width: 100%;">

    {% if simulation_type == "test" %}
        <!-- THEORY -->
        <div id="theory_column" class="col-md-6" style="padding:0px 0px 0px 0px; height: calc(100vh - 72px); display:block; background-color: rgb(240, 140, 140)">
            <div class="col-md-12" width="100%" height="100%" frameBorder="0" style="max-height: 100%; overflow-y: scroll;">
                <iframe class="col-md-12" width="100%" height="100%" frameBorder="0"></iframe>   
            </div>
        </div>

        <!-- Jupyter -->
        <div id="jupyter_column" class="col-md-6" style="height: calc(100vh - 72px); display:none;">
            <!-- Versión de Desarrollo -->
            <iframe class="col-md-12" width="100%" height="100%" frameBorder="0" style="background-color: rgb(210, 247, 156)"></iframe>
        </div>

        <!-- GAZEBO (gzweb) -->
        <div id="gazebo_column" class="col-md-6" style="height: calc(80vh - 72px)">
            {% if visor or referee %}
                <iframe class="col-md-12" width="100%" height="100%" frameBorder="0" style="background-color: rgb(213, 179, 245)"></iframe>
            {% endif %}

            {% if visor and referee %}
                <div id="gui" class="col-xs-12" style="height: calc(20vh - 72px); display:block;">
                    {% include "jderobot_kids/gui/"|add:gui|add:".html" %}
                </div>
                <div id="referee" class="col-xs-12" style="height: calc(20vh - 72px); display:none;">
                    {% include "jderobot_kids/referees/"|add:referee|add:".html" %}
                </div>

                <script type="text/javascript">

                    function switchGuiReferee() {
                        if (document.getElementById('gui').style.display == 'none') {
                            document.getElementById('gui').style.display = 'block';
                            document.getElementById('referee').style.display = 'none';
                            document.getElementById('ButtonGuiReferee').innerHTML = '<span class="glyphicon glyphicon-check"></span> Ver Árbitro'
                        }
                        else {
                            document.getElementById('gui').style.display = 'none';
                            document.getElementById('referee').style.display = 'block';
                            document.getElementById('ButtonGuiReferee').innerHTML = '<span class="glyphicon glyphicon-facetime-video"></span> Ver GUI'
                        }
                    }
                </script>
            {% elif visor %}
                <div id="gui" class="col-xs-12 text-center" style="height: calc(20vh)">
                    <img src='{% static "img/logo_jderobot_pantalla_carga.png"%}' width="130" height="130" class="d-inline-block align-top" alt="">
                </div>
            {% elif referee %}
                <div id="referee" class="col-xs-12" style="height: calc(20vh - 72px)">
                    <img src='{% static "img/logo_jderobot_pantalla_carga.png"%}' width="130" height="130" class="d-inline-block align-top" alt="">
                </div>
            {% endif %}
        </div>

    {% elif simulation_type == "real" %}

        <!-- Jupyter -->
        <div id="jupyter_column" class="col-md-9" style="padding:0px 0px 0px 0px; height: calc(100vh - 72px); display:block;">
            <!-- Versión de Desarrollo -->
            <iframe class="col-md-12" width="100%" height="100%" frameBorder="0"></iframe>
        </div> 

        <!-- THEORY -->
        <div id="theory_column" class="col-md-9" style="padding:0px 0px 0px 0px; height: calc(100vh - 72px); display:none;">
            <div class="col-md-12" width="100%" height="100%" frameBorder="0" style="max-height: 100%; overflow-y: scroll;">
                {% include "theory/"|add:exercise.exercise_id|add:".html" %}
            </div>
        </div>

        <!-- Use Guide -->
        <div id="download_guide_column" class="col-md-3" style="padding:0px 0px 0px 0px; height: calc(100vh - 72px)">
            {% comment %} {% include "jderobot_kids/download_guide.html"%} {% endcomment %}

            <h3>En esta sección podrás descargar tu código y enviarlo al PiBot.</h3>

            <div class="text-center">
                <img class="text-center" src="{% static 'img/pibot-descarga_local.png' %}" width="300px" height="250px">
            </div>

            <div class="text-center">
                <a id="downloadCode" class="btn btn-primary btn-lg" href="/download_exercise/{{exercise.exercise_id}}" target="_blank">Descargar código</a>
                <a id="sendToPi" class="btn btn-success btn-lg" href="http://10.3.141.1:8001" target="_blank">Enviar al PiBot</a>
            </div>
            <a class="btn btn-default" href="http://10.3.141.1/index.php?page=hostapd_conf" style="position: fixed; bottom: 0px; right: 0px;" target="_blank"><span class="glyphicon glyphicon-cog"></span></a>
        </div>

        <!-- Jupyter -->
        <div id="jupyter_column" class="col-md-2 col" style="padding:0px 0px 0px 0px; height: calc(100vh - 72px); display:none;">
            <button>Test</button>
        </div>

    {% endif %}

</div>

<script type="text/javascript">
    // Versión de Desarrollo
    /*socket = new WebSocket("ws://{{main_server.host}}:8000/_ws_/" + "?user={{user.username}}&client_ip={{client_ip}}&simulation_type={{simulation_type}}&main_server_ip={{main_server.ip}}&host_ip={{host.ip}}&exercise={{exercise.exercise_id}}&docker_id={{docker_id}}");
    socket.onmessage = function(e) {
        console.log("Conexión WS establecida con el Servidor")
    }
    if (socket.readyState == WebSocket.OPEN) socket.onopen();

    function switchVisible() {

        if (document.getElementById('jupyter_column').style.display == 'none') {
            document.getElementById('jupyter_column').style.display = 'block';
            document.getElementById('theory_column').style.display = 'none';
            document.getElementById('ButtonSwitch').innerHTML = '<span class="glyphicon glyphicon-pencil"></span> Ver Teoría'
        } else {
            document.getElementById('jupyter_column').style.display = 'none';
            document.getElementById('theory_column').style.display = 'block';
            document.getElementById('ButtonSwitch').innerHTML = '<span class="glyphicon glyphicon-console"></span> Ver Código'
        }
    }*/
</script>

{% endblock %}


